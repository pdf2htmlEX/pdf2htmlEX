language: cpp

sudo: true

os:
  - linux
  - osx

compiler: gcc

addons:
  apt:
    update: true
    sourceline: 'ppa:fontforge/fontforge'
    packages: 
      -Â libpoppler-private-dev
      - libcairo-dev
      - libpoppler-dev
      - libspiro-dev
      - libcairo-dev
      - libpango1.0-dev
      - libfreetype6-dev
      - libltdl-dev
      - libfontforge-dev
      - python-imaging
      - python-pip
      - firefox
      - xvfb
  homebrew:
    packages:
      - fontforge
      - poppler
      - cairo
  sauce_connect: true

before_install:
  - pip install --user selenium sauceclient
  - export DISPLAY=:99.0
  - test/start_xvfb.sh
  - pushd /
  - python -m SimpleHTTPServer 8000 >/dev/null 2>&1 &
  - popd
  - sleep 5

before_script: 
  - cmake -DENABLE_SVG=ON -DCMAKE_INSTALL_PREFIX=`pwd`/usr .

script:
  - make
  - P2H_TEST_REMOTE=1 ctest --output-on-failure --verbose
  - make install
  - /usr/local/bin/pdf2htmlEX -v

env:
  global:
    - secure: V0yGXROTAsRc3ExcECj7X/CrJLbodUeqZyfQGkA6x0iLV7Lh8/hgTjSsvuj7ef/DIWMqJ5cAIzZuXiF0KIxiVllF1v0I3w+LScxynT7B1NsyH16hvGIc7EvrsRmGVeTv8n9I+cCIwQxjtliNKfeZjV4Rk2+u6LioUzTszmW2etc=
    - secure: Q5ZSrdFEgN0JvUp90nY5Wh58iukmGZQ2EW7crOibWH2yuUsxAnMELxpY+9yV3+eA7kbjJf/I0NCa5ZY1gkxK60ugUj+zuUDTL+BV1XCbO37e0uwh3ae99iyQWpXc8e8wBp10sthoX7U6Hvypa5tD9r1JJib8jxJV/MzIFpb7H9s=
